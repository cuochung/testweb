(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c894e53"],{"0420":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"UserListOutput"},[s("div",{staticClass:"d-flex justify-space-between align-center pa-2"},[s("h2",[t._v(t._s(this.$store.state.cData.company_name)+" - 衛福部綜合功能 ")]),s("v-text-field",{staticClass:"mx-5 pa-0",attrs:{label:"搜尋...","hide-details":"","prepend-icon":"fas fa-search"},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),s("MohwStateList",{staticClass:"ml-2"})],1),s("hr"),t.dataReady?s("div",[s("div",{staticClass:"searchClass ma-2 d-flex justify-space-between align-center"},[s("v-switch",{attrs:{"hide-details":"",label:t.liveing?"入住中("+this.searchfilter.length+")":"全部("+this.searchfilter.length+")"},model:{value:t.liveing,callback:function(e){t.liveing=e},expression:"liveing"}}),t.returnCheck.length?s("div",{staticClass:"toolBar d-flex align-center"},[s("v-btn",{staticClass:"success",on:{click:function(e){return e.stopPropagation(),t.exportExcel(e)}}},[t._v("輸出EXCEL檔")]),s("v-btn",{staticClass:"primary mx-2",on:{click:function(e){return e.stopPropagation(),t.exportUsers(e)}}},[t._v("上傳基本資料")]),s("MohwSelectUpload",{staticClass:"mr-2",attrs:{users:t.returnCheck}}),s("MohwStateCheck",{staticClass:"mr-2",attrs:{users:t.returnCheck}}),s("v-alert",{staticClass:"pa-0 ma-0",attrs:{color:"primary",outlined:""}},[s("div",{staticClass:"d-flex align-center"},[s("v-text-field",{staticClass:"ml-5",attrs:{label:"月份選擇",type:"month","hide-details":""},model:{value:t.selectMonth,callback:function(e){t.selectMonth=e},expression:"selectMonth"}}),s("v-btn",{staticClass:"primary mx-1",on:{click:function(e){return e.stopPropagation(),t.printAssessment()}}},[t._v("列印全人評估")])],1)])],1):t._e()],1),s("v-data-iterator",{attrs:{items:t.searchfilter,"items-per-page":t.itemsPerPage,"footer-props":{itemsPerPageOptions:t.itemsPerPageOptions}},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[s("v-simple-table",{staticClass:"text-no-wrap",attrs:{"fixed-header":""},scopedSlots:t._u([{key:"default",fn:function(){return[s("thead",{staticClass:"font-weight-bold"},[s("tr",[s("th",[s("v-checkbox",{staticClass:"my-0",attrs:{label:"全選/全不選("+t.returnCheck.length+")","hide-details":""},on:{change:t.selectAll}})],1),s("th",{staticClass:"title"},[t._v("收案日期")]),s("th",{staticClass:"title"},[t._v("姓名")]),s("th",{staticClass:"title"},[t._v("身分證字號")]),s("th",{staticClass:"title"},[t._v("性別")]),s("th",{staticClass:"title"},[t._v("其他性別")]),s("th",{staticClass:"title"},[t._v("出生年月日")]),s("th",{staticClass:"title"},[t._v("聯絡電話")]),s("th",{staticClass:"title"},[t._v("通訊地址_縣市")]),s("th",{staticClass:"title"},[t._v("通訊地址_區域")]),s("th",{staticClass:"title"},[t._v("通訊地址")]),s("th",{staticClass:"title"},[t._v("教育程度")]),s("th",{staticClass:"title"},[t._v("教育程度其他說明")]),s("th",{staticClass:"title"},[t._v("婚姻狀況")]),s("th",{staticClass:"title"},[t._v("婚姻狀況其他說明")]),s("th",{staticClass:"title"},[t._v("宗教信仰")]),s("th",{staticClass:"title"},[t._v("宗教信仰其他說明")]),s("th",{staticClass:"title"},[t._v("過去職業")]),s("th",{staticClass:"title"},[t._v("過去職業其他說明")]),s("th",{staticClass:"title"},[t._v("家庭經濟狀況")]),s("th",{staticClass:"title"},[t._v("家庭經濟狀況其他說明")]),s("th",{staticClass:"title"},[t._v("福利")]),s("th",{staticClass:"title"},[t._v("福利種類")]),s("th",{staticClass:"title"},[t._v("福利種類其他說明")]),s("th",{staticClass:"title"},[t._v("主要照顧者")]),s("th",{staticClass:"title"},[t._v("主要照顧者姓名")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址_縣市")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址_區域")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址")]),s("th",{staticClass:"title"},[t._v("主要照顧者電話")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人")]),s("th",{staticClass:"title"},[t._v("緊急連絡人姓名")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人電話1")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人電話2")]),s("th",{staticClass:"title"},[t._v("主要醫療決定者")]),s("th",{staticClass:"title"},[t._v("主要醫療決定者姓名")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生_項目")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生 其他說明")]),s("th",{staticClass:"title"},[t._v("個案描述")])])]),s("tbody",t._l(e.items,(function(e,a){return s("tr",{key:a},[s("td",{staticClass:"d-flex align-center"},[s("v-checkbox",{staticClass:"my-0",attrs:{"hide-details":""},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"user.checked"}}),s("v-btn",{on:{click:function(s){return s.stopPropagation(),t.pushUserDataToApi(e)}}},[t._v("上傳")])],1),s("td",[t._v(t._s(e.in_date))]),s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.id_num))]),s("td",[t._v(t._s(e.sex))]),s("td"),s("td",[t._v(t._s(e.birthday))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td",[t._v(t._s(t.returnCity(e.caddress[1])))]),s("td",[t._v(t._s(t.returnZone(e.caddress[1])))]),s("td",[t._v(t._s(t.returnAddress(e.caddress[1])))]),s("td",[t._v(" "+t._s(e.nursingassessmentData?t.returnEducation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(" "+t._s(e.nursingassessmentData&&"其他"==t.returnEducation(e.nursingassessmentData)?t.returnEducation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(t._s(t.returnMarry(e)))]),s("td",[t._v(t._s(e.marry7?e.marry7:"其他"))]),s("td",[t._v(" "+t._s(e.faith?"道教"==e.faith?"道教或民間傳統信仰":e.faith:"無")+" ")]),s("td",[t._v(t._s("其他"==e.faith?"其他":""))]),s("td",[t._v(" "+t._s(e.nursingassessmentData?t.returnOccupation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(" "+t._s(e.nursingassessmentData&&"其他"==t.returnOccupation(e.nursingassessmentData)?t.returnOccupation(e.nursingassessmentData):"")+" ")]),s("td",[t._v("其他")]),s("td",[t._v("無資料")]),s("td",[t._v("無")]),s("td"),s("td"),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td",[t._v(t._s(t.returnCity(e.caddress[1])))]),s("td",[t._v(t._s(t.returnZone(e.caddress[1])))]),s("td",[t._v(t._s(t.returnAddress(e.caddress[1])))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td"),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td"),s("td"),s("td"),s("td")])})),0)]},proxy:!0}],null,!0)})]}}],null,!1,3744173440)})],1):t._e(),t.dataReady?t._e():s("div",{staticClass:"d-flex justify-center align-center",staticStyle:{height:"100vh"}},[s("span",[t._v(" 資料讀取&處理中... "),s("v-icon",[t._v("fas fa-spinner fa-spin")])],1)]),t.dataReady?s("div",[s("table",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"outputtable"}},[t._m(0),s("tbody",t._l(t.returnCheck,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(e.in_date))]),s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(e.id_num))]),s("td",[t._v(t._s(e.sex))]),s("td"),s("td",[t._v(t._s(e.birthday))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td",[t._v(t._s(t.returnCity(e.caddress[1])))]),s("td",[t._v(t._s(t.returnZone(e.caddress[1])))]),s("td",[t._v(t._s(t.returnAddress(e.caddress[1])))]),s("td",[t._v(" "+t._s(e.nursingassessmentData?t.returnEducation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(" "+t._s(e.nursingassessmentData&&"其他"==t.returnEducation(e.nursingassessmentData)?t.returnEducation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(t._s(t.returnMarry(e)))]),s("td",[t._v(t._s(e.marry7?e.marry7:"其他"))]),s("td",[t._v(" "+t._s(e.faith?"道教"==e.faith?"道教或民間傳統信仰":e.faith:"無")+" ")]),s("td",[t._v(t._s("其他"==e.faith?"其他":""))]),s("td",[t._v(" "+t._s(e.nursingassessmentData?t.returnOccupation(e.nursingassessmentData):"")+" ")]),s("td",[t._v(" "+t._s(e.nursingassessmentData&&"其他"==t.returnOccupation(e.nursingassessmentData)?t.returnOccupation(e.nursingassessmentData):"")+" ")]),s("td",[t._v("其他")]),s("td",[t._v("無資料")]),s("td",[t._v("無")]),s("td"),s("td"),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td",[t._v(t._s(t.returnCity(e.caddress[1])))]),s("td",[t._v(t._s(t.returnZone(e.caddress[1])))]),s("td",[t._v(t._s(t.returnAddress(e.caddress[1])))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td",[t._v(t._s(e.cphone[1]))]),s("td"),s("td",[t._v(t._s(e.crelationship[1]))]),s("td",[t._v(t._s(e.cman[1]))]),s("td"),s("td"),s("td"),s("td")])})),0)])]):t._e()])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",{staticClass:"font-weight-bold"},[s("tr",[s("th",{staticClass:"title"},[t._v("收案日期")]),s("th",{staticClass:"title"},[t._v("姓名")]),s("th",{staticClass:"title"},[t._v("身分證字號")]),s("th",{staticClass:"title"},[t._v("性別")]),s("th",{staticClass:"title"},[t._v("其他性別")]),s("th",{staticClass:"title"},[t._v("出生年月日")]),s("th",{staticClass:"title"},[t._v("聯絡電話")]),s("th",{staticClass:"title"},[t._v("通訊地址_縣市")]),s("th",{staticClass:"title"},[t._v("通訊地址_區域")]),s("th",{staticClass:"title"},[t._v("通訊地址")]),s("th",{staticClass:"title"},[t._v("教育程度")]),s("th",{staticClass:"title"},[t._v("教育程度其他說明")]),s("th",{staticClass:"title"},[t._v("婚姻狀況")]),s("th",{staticClass:"title"},[t._v("婚姻狀況其他說明")]),s("th",{staticClass:"title"},[t._v("宗教信仰")]),s("th",{staticClass:"title"},[t._v("宗教信仰其他說明")]),s("th",{staticClass:"title"},[t._v("過去職業")]),s("th",{staticClass:"title"},[t._v("過去職業其他說明")]),s("th",{staticClass:"title"},[t._v("家庭經濟狀況")]),s("th",{staticClass:"title"},[t._v("家庭經濟狀況其他說明")]),s("th",{staticClass:"title"},[t._v("福利")]),s("th",{staticClass:"title"},[t._v("福利種類")]),s("th",{staticClass:"title"},[t._v("福利種類其他說明")]),s("th",{staticClass:"title"},[t._v("主要照顧者")]),s("th",{staticClass:"title"},[t._v("主要照顧者姓名")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址_縣市")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址_區域")]),s("th",{staticClass:"title"},[t._v("主要照顧者地址")]),s("th",{staticClass:"title"},[t._v("主要照顧者電話")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人")]),s("th",{staticClass:"title"},[t._v("緊急連絡人姓名")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人電話1")]),s("th",{staticClass:"title"},[t._v("緊急聯絡人電話2")]),s("th",{staticClass:"title"},[t._v("主要醫療決定者")]),s("th",{staticClass:"title"},[t._v("主要醫療決定者姓名")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生_項目")]),s("th",{staticClass:"title"},[t._v("一年內有無重大事件發生 其他說明")]),s("th",{staticClass:"title"},[t._v("個案描述")])])])}],n=(s("a4d3"),s("4de4"),s("7db0"),s("caad"),s("d81d"),s("b0c0"),s("e439"),s("dbb4"),s("b64b"),s("d3b7"),s("2532"),s("1276"),s("159b"),s("ade3")),i=(s("96cf"),s("1146")),c=s.n(i),o=s("5a0c"),l=s.n(o),u=s("f858"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MohwStateList"},[s("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[s("v-btn",t._g({on:{click:t.showDialog}},a),[t._v("顯示上傳狀態 ("+t._s(t.$store.state.mohw_url.includes("NursingHome")?"測試機":"正式機")+")")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",[s("h3",{staticClass:"font-weight-bold"},[t._v("衛福部上傳資料訊息")]),s("v-spacer"),s("v-text-field",{attrs:{type:"date",label:"選擇日期(起)"},on:{change:function(e){return t.getNursingHomeGetLog()}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),s("v-card-text",[t._v(" 顯示筆數: "+t._s(t.getItems.length)+" "),s("v-simple-table",[s("thead",[s("tr",{staticClass:"grey lighten-2"},[s("th",{staticClass:"text-no-wrap"},[t._v("log_date 日期/時間")]),s("th",[t._v("log_content 狀態")])])]),s("tbody",t._l(t.getItems,(function(e,a){return s("tr",{key:a},[s("td",{staticClass:"text-no-wrap"},[t._v(t._s(e.log_date))]),s("td",[t._v(t._s(e.log_content))])])})),0)])],1)],1)],1)],1)},h=[],v=(s("4e827"),{data:function(){return{dialog:!1,startDate:l()().format("YYYY-MM-DD"),getItems:[]}},methods:{showDialog:function(){this.getNursingHomeGetLog()},getNursingHomeGetLog:function(){var t=this;if(console.log("run"),!this.$store.state.cData.sKEY||!this.$store.state.cData.aID){var e={msg:"衛福部授權碼不合法,請重新確認!!",type:!0,theme:"warning"};return this.$store.commit("snackbar",e),!1}var s=this.$store.state.cData.sKEY,a=this.$store.state.cData.aID;this.$store.state.mohw_url.includes("NursingHome")&&(s="ApEy6o08+Ij3lCK/c+JSA55aSMarOb");var r={url:"".concat(this.$store.state.mohw_url,"/GetLog"),SecretKey:s,AGENCY_ID:a,formData:{start_date:l()(this.startDate).format("YYYY/MM/DD")}};this.$api.options("posttoapi/getlog",r).then((function(e){t.getItems=JSON.parse(JSON.parse(e).data).sort((function(t,e){return t.log_date<e.log_date?1:-1}))}))}}}),p=v,m=(s("5e3d"),s("2877")),f=s("6544"),_=s.n(f),g=s("8336"),b=s("b0af"),y=s("99d9"),C=s("169a"),D=s("1f4f"),x=s("2fa4"),w=s("8654"),O=Object(m["a"])(p,d,h,!1,null,"515cc8a7",null),k=O.exports;_()(O,{VBtn:g["a"],VCard:b["a"],VCardText:y["d"],VCardTitle:y["e"],VDialog:C["a"],VSimpleTable:D["a"],VSpacer:x["a"],VTextField:w["a"]});var S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MohwStateCheck"},[s("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){return[s("v-btn",{on:{click:t.showDialog}},[t._v("確認已上傳資料狀態 ("+t._s(t.$store.state.mohw_url.includes("NursingHome")?"測試機":"正式機")+")")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",[s("h3",{staticClass:"font-weight-bold"},[t._v("已上傳資料狀態 本次判斷筆數 ("+t._s(t.feedbackMsg.length)+") ")]),s("v-spacer")],1),s("v-card-text",[s("v-simple-table",[s("thead",[s("tr",{staticClass:"grey lighten-2"},[s("th",[t._v("判斷碼")]),s("th",[t._v("訊息內容")])])]),s("tbody",t._l(t.feedbackMsg,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(e.code))]),s("td",[t._v(t._s(200==e.code?JSON.parse(e.data)[0]:e.data))])])})),0)])],1)],1)],1)],1)},E=[];s("a9e3"),s("3ca3"),s("ddb0");function j(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?j(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var $={props:["users"],data:function(){return{dialog:!1,feedbackMsg:[],mohwDocumentsArr:[{text:"健康習慣",database:"healthyhabits"},{text:"疾病史",database:"medicalhistories"},{text:"藥物安全評估",database:"drugsafeties"},{text:"身體評估",database:"bodyevaluations"},{text:"壓力性損傷危險評估",database:"pressureinjuries"},{text:"跌倒危險性評估",database:"fallrisks"},{text:"日常生活功能評估",database:"adls"},{text:"工具性日常生活活動功能評估",database:"iadls"},{text:"認知功能評估",database:"dementias"},{text:"情緒問題評估",database:"geriatricdepressionscales"},{text:"簡易營養評估",database:"mnasfs"},{text:"疼痛評估",database:"painevaluations"},{text:"衰弱評估",database:"sofs"}]}},methods:{showDialog:function(){var t=this;if(this.users.length>1){var e={msg:"目前僅提供確認單一住民資料,請勿勾選超過二位住民!!",type:!0,theme:"warning"};this.$store.commit("snackbar",e)}else this.$confirm("確認已上傳資料狀態? (僅判斷已上傳,但尚未確認資料)").then((function(e){e&&(t.dialog=!0,t.checkProcess())}))},checkProcess:function(){var t,e,s,a=this;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return t=[],e=0,r.next=4,regeneratorRuntime.awrap(Promise.all(this.mohwDocumentsArr.map((function(s){return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(a.$api.get(s.database).then((function(r){var n;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(r.map((function(t){return P({},JSON.parse(t.datalist),{snkey:t.snkey})})).filter((function(t){return t.uploadData&&!t.uploadState})).filter((function(t){return t.user_snkey==a.users[0].snkey})));case 2:return n=i.sent,e+=Number(n.length),i.next=6,regeneratorRuntime.awrap(Promise.all(n.map((function(e){var a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(u["a"].checkMOHWData(e,s.database,!1));case 2:a=r.sent,t.push(a);case 4:case"end":return r.stop()}}))}))));case 6:case"end":return i.stop()}}))})));case 2:case"end":return r.stop()}}))}))));case 4:this.feedbackMsg=t,0==e&&(s={msg:"目前暫無任何未上傳資料..",type:!0,theme:"success"},this.$store.commit("snackbar",s));case 6:case"end":return r.stop()}}),null,this)}}},M=$,N=(s("a395"),Object(m["a"])(M,S,E,!1,null,"4cac86bc",null)),A=N.exports;_()(N,{VBtn:g["a"],VCard:b["a"],VCardText:y["d"],VCardTitle:y["e"],VDialog:C["a"],VSimpleTable:D["a"],VSpacer:x["a"]});var I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MohwSelectUpload"},[s("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){return[s("v-btn",{staticClass:"warning",on:{click:function(e){return t.checkUserCount()}}},[t._v("上傳全人評估")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",[s("h3",{staticClass:"font-weight-bold"},[t._v("衛福部全人評估表單 上傳資料選擇")])]),s("v-card-text",[s("v-alert",{attrs:{color:"primary",outlined:""}},[s("div",{staticClass:"d-flex"},[s("h3",{staticClass:"font-weight-bold"},[t._v("日期設定")]),s("v-text-field",{staticClass:"ml-6",attrs:{type:"date",label:"日期(起)"},model:{value:t.list.startDate,callback:function(e){t.$set(t.list,"startDate",e)},expression:"list.startDate"}}),s("v-text-field",{staticClass:"ml-2",attrs:{type:"date",label:"日期(迄)"},model:{value:t.list.endDate,callback:function(e){t.$set(t.list,"endDate",e)},expression:"list.endDate"}})],1)]),s("v-alert",{attrs:{color:"primary",outlined:""}},[s("div",[s("div",{staticClass:"d-flex justify-space-between align-center"},[s("h3",{staticClass:"font-weight-bold"},[t._v("全人評估表單選擇")]),s("v-checkbox",{staticClass:"pa-0 red lighten-3 pa-2",staticStyle:{"border-radius":"5px"},attrs:{label:"全選","hide-details":""},on:{change:t.selectAll}})],1),s("div",{staticClass:"d-flex flex-wrap justify-space-between"},t._l(t.mohwDocumentsArr,(function(e){return s("v-checkbox",{key:e.text,staticClass:"ml-3 pa-0",attrs:{label:e.text,value:e.database,"hide-details":""},model:{value:t.list.mohwDocuments,callback:function(e){t.$set(t.list,"mohwDocuments",e)},expression:"list.mohwDocuments"}})})),1)])]),s("v-divider"),s("div",{staticClass:"mt-2 text-right"},[s("v-btn",{staticClass:"primary",on:{click:function(e){return t.confirmUpload()}}},[t._v("確認上傳")])],1)],1)],1)],1)],1)},R=[];s("99af");function V(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function J(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?V(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var Y={props:["users"],data:function(){return{dialog:!1,list:{startDate:l()().format("YYYY-MM-DD"),endDate:l()().format("YYYY-MM-DD"),mohwDocuments:[]},mohwDocumentsArr:[{text:"健康習慣",database:"healthyhabits"},{text:"疾病史",database:"medicalhistories"},{text:"藥物安全評估",database:"drugsafeties"},{text:"身體評估",database:"bodyevaluations"},{text:"壓力性損傷危險評估",database:"pressureinjuries"},{text:"跌倒危險性評估",database:"fallrisks"},{text:"日常生活功能評估",database:"adls"},{text:"工具性日常生活活動功能評估",database:"iadls"},{text:"認知功能評估",database:"dementias"},{text:"情緒問題評估",database:"geriatricdepressionscales"},{text:"簡易營養評估",database:"mnasfs"},{text:"疼痛評估",database:"painevaluations"},{text:"衰弱評估",database:"sofs"}]}},methods:{checkUserCount:function(){if(this.users.length>1){var t={msg:"目前僅提供上傳單一住民資料,請勿勾選超過二位住民!!",type:!0,theme:"warning"};this.$store.commit("snackbar",t)}else this.dialog=!0},confirmUpload:function(){var t,e=this;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(0!=this.list.mohwDocuments.length){s.next=4;break}return t={msg:"未選擇任何表單!!",type:!0,theme:"warning"},this.$store.commit("snackbar",t),s.abrupt("return",!1);case 4:return s.next=6,regeneratorRuntime.awrap(this.$confirm("確認上傳資料?").then((function(t){var s,a,r,n;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(!t){i.next=16;break}return e.dialog=!1,s=[],i.next=5,regeneratorRuntime.awrap(Promise.all(e.list.mohwDocuments.map((function(t){return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(e.getZoneData(t));case 2:s[t]=a.sent;case 3:case"end":return a.stop()}}))}))));case 5:return a=[],e.users.forEach((function(t){var r=[];r["user"]={id_num:t.id_num,in_date:t.in_date,name:t.name,snkey:t.snkey},e.list.mohwDocuments.map((function(e){r[e]=s[e].filter((function(e){return e.user_snkey==t.snkey}))})),a.push(r)})),console.log("userMohwData",a),r=[],a.forEach((function(t){r.push({CaseID:t.user.id_num,EndDate:t.user.in_date,HealthyHabits:t.healthyhabits?u["a"].returnHealthyHabitsJSON(t.healthyhabits):[],MedicalHistories:t.medicalhistories?u["a"].returnMedicalHistoriesJSON(t.medicalhistories):[],DrugSafeties:t.drugsafeties?u["a"].returnDrugSafetiesJSON(t.drugsafeties):[],BodyEvaluations:t.bodyevaluations?u["a"].returnBodyEvaluationsJSON(t.bodyevaluations):[],PressureInjuries:t.pressureinjuries?u["a"].returnPressureInjuriesJSON(t.pressureinjuries):[],FallRisks:t.fallrisks?u["a"].returnFallRisksJSON(t.fallrisks):[],ADLs:t.adls?u["a"].returnADLsJSON(t.adls):[],IADLs:t.iadls?u["a"].returnIADLsJSON(t.iadls):[],Dementias:t.dementias?u["a"].returnDementiasJSON(t.dementias):[],GeriatricDepressionScales:t.geriatricdepressionscales?u["a"].returnGeriatricDepressionScalesJSON(t.geriatricdepressionscales):[],MNASFs:t.mnasfs?u["a"].returnMNASFsJSON(t.mnasfs):[],PainEvaluations:t.painevaluations?u["a"].returnPainEvaluationsJSON(t.painevaluations):[],SOFs:t.sofs?u["a"].returnSOFsJSON(t.sofs):[]})})),i.next=12,regeneratorRuntime.awrap(u["a"].uploadtoMOHW(r,"Evaluation"));case 12:if(n=i.sent,200!=n.code){i.next=16;break}return i.next=16,regeneratorRuntime.awrap(Promise.all(a.map((function(t){return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:e.list.mohwDocuments.map((function(s){return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:t[s].map((function(t){var a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return t.uploadData=n,t.uploadState&&delete t.uploadState,a={snkey:t.snkey,datalist:JSON.stringify(t),edit_man:"pass"},r.next=5,regeneratorRuntime.awrap(e.$api.options("general/edit/"+e.$store.state.databaseName+"/"+s,a));case 5:case"end":return r.stop()}}))}));case 1:case"end":return a.stop()}}))}));case 1:case"end":return s.stop()}}))}))));case 16:case"end":return i.stop()}}))})));case 6:case"end":return s.stop()}}),null,this)},getZoneData:function(t){var e,s;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return e={key:'"Date":"',start:l()(this.list.startDate).format("YYYY-MM-DD"),end:l()(this.list.endDate).format("YYYY-MM-DD")},s="general/getZoneData/".concat(this.$store.state.databaseName,"/").concat(t),a.next=4,regeneratorRuntime.awrap(this.$api.options(s,e).then((function(t){return t.map((function(t){return J({},JSON.parse(t.datalist),{snkey:t.snkey})}))})));case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}}),null,this)},selectAll:function(t){this.list.mohwDocuments=t?["healthyhabits","medicalhistories","drugsafeties","bodyevaluations","pressureinjuries","fallrisks","adls","iadls","dementias","geriatricdepressionscales","mnasfs","painevaluations","sofs"]:[]}}},T=Y,H=s("0798"),L=s("ac7c"),K=s("ce7e"),U=Object(m["a"])(T,I,R,!1,null,null,null),B=U.exports;function Z(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function F(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Z(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}_()(U,{VAlert:H["a"],VBtn:g["a"],VCard:b["a"],VCardText:y["d"],VCardTitle:y["e"],VCheckbox:L["a"],VDialog:C["a"],VDivider:K["a"],VTextField:w["a"]});var G={components:{MohwStateList:k,MohwStateCheck:A,MohwSelectUpload:B},data:function(){return{items:null,userItems:null,nursingassessmentItems:null,nursingrecordItems:null,searchKey:"",itemsPerPageOptions:[10,20,30],itemsPerPage:10,liveing:!0,selectedFile:null,haveChecked:[],selectMonth:l()().format("YYYY-MM")}},watch:{dataReady:function(t){var e=this;t&&this.items.forEach((function(t){t.nursingassessmentData=e.nursingassessmentItems.find((function(e){return e.u_snkey==t.snkey}))}))}},computed:{dataReady:function(){return null!=this.userItems&&null!=this.nursingassessmentItems&&(this.items=this.userItems,!0)},searchfilter:function(){var t=this.searchKey.split(" "),e="",s=t.reduce((function(t,s){return t.filter((function(t){if(e=JSON.stringify(t).toUpperCase(),e.includes(s.toUpperCase()))return t}))}),this.items);return this.liveing?s.filter((function(t){return t.bed_name})):s},returnCheck:function(){return this.searchfilter.filter((function(t){return t.checked}))}},created:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:if(null==sessionStorage.getItem("pData")){t.next=10;break}return this.$store.commit("setcData",JSON.parse(sessionStorage.getItem("cData"))),this.$store.commit("setpData",JSON.parse(sessionStorage.getItem("pData"))),t.next=5,regeneratorRuntime.awrap(this.getUserItems());case 5:return t.next=7,regeneratorRuntime.awrap(this.getData("nursingassessment"));case 7:this.getData("nursingrecord"),t.next=11;break;case 10:this.$router.push("/login");case 11:case"end":return t.stop()}}),null,this)},methods:{selectAll:function(t){var e=this;this.searchfilter.forEach((function(s){t?e.$set(s,"checked",!0):e.$set(s,"checked",!1)}))},printAssessment:function(){if(this.returnCheck.length){var t={month:this.selectMonth,userItems:this.returnCheck.map((function(t){return{snkey:t.snkey,name:t.name,p_code:t.p_code,bed_name:t.bed_name}}))},e=this.$router.resolve({path:"/print/assessmentprint",query:{data:JSON.stringify(t)}});window.open(e.href,"_blank")}},getNursingHomeGetLog:function(){var t="http://114.34.167.172:49153/NursingHome/API/nhcApi/GetLog",e={start_date:"2021/12/28"},s="ApEy6o08+Ij3lCK/c+JSA55aSMarOb",a="7405310211",r={url:t,SecretKey:s,AGENCY_ID:a,formData:e};this.$api.options("posttoapi/getlog",r).then((function(t){console.log("rs:",t)}))},exportUsers:function(){var t=this;this.$confirm("確認上傳住民資料?").then((function(e){if(e){var s=[],a=!1,r="";if(t.returnCheck.forEach((function(e){0!=t.returnCity(e.caddress[1])&&0!=t.returnZone(e.caddress[1]).length&&0!=t.returnAddress(e.caddress[1]).length||(r+=e.name+"-地址不可空白或異常!! ",a=!0),e.nursingassessmentData||(r+=e.name+"入院護理評估未建檔!! ",a=!0),a||s.push(t.userDataToJson(e))})),a)return alert(r),!1;u["a"].uploadtoMOHW(s,"BaseData")}}))},pushUserDataToApi:function(t){var e=this;this.$confirm("確認上傳人員資料("+t.name+")到衛福部?").then((function(s){if(s){var a=[],r=!1,n="";if(0!=e.returnCity(t.caddress[1])&&0!=e.returnZone(t.caddress[1]).length&&0!=e.returnAddress(t.caddress[1]).length||(n+='"地址不可空白或異常!!',r=!0),t.nursingassessmentData||(n+="入院護理評估未建檔!!",r=!0),r)return alert(n),!1;if(a.push(e.userDataToJson(t)),!e.$store.state.cData.sKEY||!e.$store.state.cData.aID){var i={msg:"衛福部授權碼不合法,請重新確認!!",type:!0,theme:"warning"};return e.$store.commit("snackbar",i),!1}var c=e.$store.state.cData.sKEY,o=e.$store.state.cData.aID,l="".concat(e.$store.state.mohw_url,"/BaseData");e.$store.state.mohw_url.includes("NursingHome")&&(c="ApEy6o08+Ij3lCK/c+JSA55aSMarOb");var u={url:l,SecretKey:c,AGENCY_ID:o,jsonfile:JSON.stringify({DataList:a})};e.$api.options("posttoapi/postjson",u).then((function(t){console.log(t);var e=JSON.parse(t);200==e.code&&alert("上傳成功!")}))}}))},userDataToJson:function(t){return{EndDate:t.in_date,CaseName:t.name,CaseID:t.id_num,Sex:{Value:t.sex,Other:null},Birthdate:{Refuse:"",Date:t.birthday},PhoneNumber:{Refuse:"",Value:t.cphone[1]},Address:{Refuse:"",City:this.returnCity(t.caddress[1]),Area:this.returnZone(t.caddress[1]),Lane:this.returnAddress(t.caddress[1])},Education:{Value:this.returnEducation(t.nursingassessmentData),Other:"其他"==this.returnEducation(t.nursingassessmentData)?"其他":""},Marriage:{Value:this.returnMarry(t),Other:"其他"==this.returnMarry(t)?this.returnMarry(t):""},Religion:{Value:t.faith?"道教"==t.faith?"道教或民間傳統信仰":t.faith:"無",Other:"其他"==t.faith?"其他":null},ExJob:{Value:this.returnOccupation(t.nursingassessmentData),Other:"其他"==this.returnOccupation(t.nursingassessmentData)?this.returnOccupation(t.nursingassessmentData):""},Economic:{Value:"其他",Other:"無資料"},HasWelfare:"無",Welfare:null,CaregiverID:"其他",CaregiverName:t.cman[1],CaregiverAddress:{City:this.returnCity(t.caddress[1]),Area:this.returnZone(t.caddress[1]),Lane:this.returnAddress(t.caddress[1])},CaregiverTel:t.cphone[1],EgyContactRelation:"其他",EgyContactName:t.cman[1],EgyContactTel1:t.cphone[1],EgyContactTel2:null,DecisionMakerRelation:{Value:"其他",Other:t.crelationship[1]},MEvent:"無",MEventItem:null,CaseDesc:t.nursingrecordData&&t.nursingrecordData[0]?t.nursingrecordData[0].nursingrecord_content:"",CreateID:""}},returnAddress:function(t){return t.includes("區")?t.split("區")[1]:t.includes("市")?t.split("市")[1]:t.includes("縣")?t.split("縣")[1]:""},returnZone:function(t){if(t.includes("區")){var e=t.split("區")[0];if(e.includes("市")){var s=e.split("市");return s[1]+"區"}if(e.includes("縣")){var a=e.split("縣");return a[1]+"縣"}return e+"區"}if(t.includes("鄉")){var r=t.split("鄉")[0];if(r.includes("縣")){var n=r.split("縣");return n[1]+"鄉"}return r+"鄉"}return""},returnCity:function(t){if(t.includes("市")){var e=t.split("市");return e[0]+"市"}if(t.includes("縣")){var s=t.split("縣");return s[0]+"縣"}return""},returnIdentity:function(t){return t.identity1?"一般":t.identity1?"中低收入戶":t.identity1?"低收入戶(一款)":t.identity1?"低收入戶(二款)":t.identity1?"低收入戶(三款)":t.identity1?"原住民":t.identity1?"一般":void 0},returnOccupation:function(t){return t.occupation1?"軍公教":t.occupation2?"工商服務業":t.occupation3?"工商服務業":t.occupation4?"軍公教":t.occupation5?"漁農牧業":t.occupation6?"無":t.occupation7?"其他":"無"},returnMarry:function(t){return t.marry1?"未婚":t.marry2?"已婚":t.marry3?"離異":t.marry4?"喪偶":t.marry5?"分居":t.marry6?"其他":void 0},returnEducation:function(t){return t.education1?"不識字":t.education2?"識字未就學":t.education3?"小學":t.education4?"初中(職)":t.education5?"高中(職)":t.education6?"大學(專技)以上":t.education7?"大學(專技)以上":(t.education8,"其他")},exportExcel:function(){this.$confirm("確認轉出EXCEL檔案?").then((function(t){if(t){var e=c.a.utils.table_to_book(document.getElementById("outputtable")),s="住民一覽表.xlsx";try{c.a.writeFile(e,s)}catch(a){console.log(a,e)}}}))},getUserItems:function(){var t=this;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.$api.options("user/getAll/"+this.$store.state.databaseName).then((function(e){t.userItems=e})));case 2:case"end":return e.stop()}}),null,this)},getData:function(t){var e=this;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(this.$api.get(t).then((function(s){e[t+"Items"]=s.map((function(t){return F({u_snkey:t.u_snkey},JSON.parse(t.datalist))}))})));case 2:case"end":return s.stop()}}),null,this)},getByKey:function(t,e){var s={key:"u_snkey",value:t.snkey};return this.$api.options("general/getByKey/"+this.$store.state.databaseName+"/"+e,s)}}},W=G,X=s("c377"),q=s("132d"),z=s("b73d"),Q=Object(m["a"])(W,a,r,!1,null,null,null);e["default"]=Q.exports;_()(Q,{VAlert:H["a"],VBtn:g["a"],VCheckbox:L["a"],VDataIterator:X["a"],VIcon:q["a"],VSimpleTable:D["a"],VSwitch:z["a"],VTextField:w["a"]})},"5e3d":function(t,e,s){"use strict";s("ad11")},"881b":function(t,e,s){},a395:function(t,e,s){"use strict";s("881b")},ad11:function(t,e,s){}}]);
//# sourceMappingURL=chunk-2c894e53.035fe1bb.js.map