(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6c71286"],{"0dc9":function(t,e,s){"use strict";s("34b2")},2792:function(t,e,s){"use strict";s("df74")},"32e6":function(t,e,s){"use strict";s("d243")},"34b2":function(t,e,s){},b7ad:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MedicationList"},[s("v-dialog",{attrs:{width:"90%"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[s("v-btn",t._g({staticClass:"primary",on:{click:function(e){return e.stopPropagation(),t.addProcess()}}},i),[t._v("照護師資料維護")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",{staticClass:"font-weight-black primary lighten-2 white--text"},[s("h2",[t._v("照護藥師資料維護")]),"edit"==t.processModel?s("div",{staticClass:"success px-4 pa-1 mx-2",staticStyle:{"border-radius":"5px"}},[t._v("修改模式中...")]):t._e(),s("v-spacer"),s("v-icon",{on:{click:function(e){e.stopPropagation(),t.dialog=!t.dialog}}},[t._v("mdi-close")])],1),s("v-divider"),s("v-card-text",[s("v-form",{ref:"form"},[s("v-row",[s("v-col",{attrs:{cols:"6"}},[s("v-text-field",{attrs:{label:"姓名",rules:t.emptyRules},model:{value:t.list.name,callback:function(e){t.$set(t.list,"name",e)},expression:"list.name"}})],1),s("v-col",{attrs:{cols:"6"}},[s("v-text-field",{attrs:{label:"電話",rules:t.emptyRules},model:{value:t.list.tel,callback:function(e){t.$set(t.list,"tel",e)},expression:"list.tel"}})],1),s("v-col",{attrs:{cols:"6"}},[s("v-text-field",{attrs:{label:"藥師證號",rules:t.emptyRules},model:{value:t.list.license,callback:function(e){t.$set(t.list,"license",e)},expression:"list.license"}})],1),s("v-col",{attrs:{cols:"6"}},[s("v-text-field",{attrs:{label:"藥局名稱",rules:t.emptyRules},model:{value:t.list.pharmacyName,callback:function(e){t.$set(t.list,"pharmacyName",e)},expression:"list.pharmacyName"}})],1),s("v-col",{attrs:{cols:"12"}},[s("v-text-field",{attrs:{label:"地址",rules:t.emptyRules},model:{value:t.list.address,callback:function(e){t.$set(t.list,"address",e)},expression:"list.address"}})],1)],1)],1),s("v-card-actions",[s("v-spacer"),"add"==t.processModel?s("v-btn",{staticClass:"primary",on:{click:function(e){return e.stopPropagation(),t.addOK(e)}}},[t._v("確認新增")]):t._e(),"edit"==t.processModel?s("v-btn",{staticClass:"success",on:{click:function(e){return e.stopPropagation(),t.editOK(e)}}},[t._v("確認修改")]):t._e()],1),s("v-divider"),s("div",{staticClass:"grey lighten-3 pa-2 rounded my-2"},[s("h2",[t._v("醫師資料")]),s("v-divider"),s("v-simple-table",[s("thead",[s("tr",[s("th",[t._v("姓名")]),s("th",[t._v("電話")]),s("th",[t._v("藥師證號")]),s("th",[t._v("藥局名稱")]),s("th",[t._v("地址")])])]),s("tbody",t._l(t.items,(function(e){return s("tr",{key:e.snkey},[s("td",[s("v-icon",{staticClass:"success",on:{click:function(s){return s.stopPropagation(),t.editModal(e)}}},[t._v("mdi-pencil")]),s("v-icon",{staticClass:"error mx-1",on:{click:function(s){return s.stopPropagation(),t.del(e)}}},[t._v("mdi-close")]),t._v(" "+t._s(e.name)+" ")],1),s("td",[t._v(t._s(e.tel))]),s("td",[t._v(t._s(e.license))]),s("td",[t._v(t._s(e.pharmacyName))]),s("td",[t._v(t._s(e.address))])])})),0)])],1)],1)],1)],1)],1)},a=[],l=(s("a4d3"),s("4de4"),s("d81d"),s("e439"),s("dbb4"),s("b64b"),s("159b"),s("ade3")),n=s("5a0c"),r=s.n(n);function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){Object(l["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var d={data:function(){return{processModel:"add",emptyRules:[function(t){return!!t||"不可空白"}],dialog:!1,list:{}}},computed:{items:function(){return this.$store.state.medicationItems.map((function(t){var e=JSON.parse(t.datalist);return e.snkey=t.snkey,e}))}},created:function(){this.getAllData()},methods:{getAllData:function(){this.$store.dispatch("getItems","medication")},addProcess:function(){var t=this;this.processModel="add",this.list={},this.$nextTick((function(){t.$refs.form.resetValidation()}))},addOK:function(){var t=this;if(this.$refs.form.validate()){this.list.u_snkey=this.$store.state.uData.snkey,this.list.create_man=this.$store.state.pData.username+"("+r()().format("YYYY-MM-DD HH:mm:ss")+")";var e={datalist:JSON.stringify(this.list)};this.$api.options("general/add/"+this.$store.state.databaseName+"/medication",e).then((function(e){if(1==e.state){var s={msg:"已新增",type:!0,theme:"success"};t.$store.commit("snackbar",s),t.list={},t.getAllData(),t.$refs.form.resetValidation()}}))}else{var s={msg:"資料輸入不完全!!請重新確認!!",type:!0,theme:"warning"};this.$store.commit("snackbar",s)}},editModal:function(t){this.processModel="edit",this.list=c({},t)},editOK:function(){var t=this;if(this.$refs.form.validate()){this.list.edit_man||(this.list.edit_man=""),this.list.edit_man=this.$store.state.pData.username+"("+r()().format("YYYY-MM-DD HH:mm:ss")+")"+this.list.edit_man;var e={snkey:this.list.snkey,datalist:JSON.stringify(this.list),edit_man:""};this.$api.options("general/edit/"+this.$store.state.databaseName+"/medication",e).then((function(e){if(1==e.state){var s={msg:"已修改",type:!0,theme:"success"};t.$store.commit("snackbar",s),t.list={},t.processModel="add",t.getAllData(),t.$refs.form.resetValidation()}}))}else{var s={msg:"資料輸入不完全!!請重新確認!!",type:!0,theme:"warning"};this.$store.commit("snackbar",s)}},del:function(t){var e=this;this.$confirm("確認刪除?").then((function(s){t.delman=e.$store.state.pData.username+"("+r()().format("YYYY-MM-DD HH:mm:ss")+")";var i={snkey:t.snkey,tablename:"medication",info:JSON.stringify(t)};s&&e.$api.options("general/delv3/"+e.$store.state.databaseName+"/"+i.tablename,i).then((function(t){if(1==t.state){var s={msg:"已刪除",type:!0,theme:"success"};e.$store.commit("snackbar",s),e.getAllData()}}))}))}}},u=d,v=(s("32e6"),s("2877")),m=s("6544"),f=s.n(m),p=s("8336"),h=s("b0af"),_=s("99d9"),b=s("62ad"),y=s("169a"),g=s("ce7e"),k=s("4bd4"),$=s("132d"),D=s("0fd9"),x=s("1f4f"),M=s("2fa4"),O=s("8654"),I=Object(v["a"])(u,i,a,!1,null,"98a0cea8",null);e["a"]=I.exports;f()(I,{VBtn:p["a"],VCard:h["a"],VCardActions:_["b"],VCardText:_["d"],VCardTitle:_["e"],VCol:b["a"],VDialog:y["a"],VDivider:g["a"],VForm:k["a"],VIcon:$["a"],VRow:D["a"],VSimpleTable:x["a"],VSpacer:M["a"],VTextField:O["a"]})},c8e8:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MedicationEvaluationList"},[s("v-card",[s("v-card-title",[s("h2",{staticClass:"subheading grey--text"},[s("v-icon",{staticClass:"mx-1"},[t._v("fas fa-file-alt")]),s("span",[t._v(" "+t._s(this.$store.state.uData.p_code)+" / "+t._s(this.$store.state.uData.name)+" ")]),s("span",[t._v("用藥評估紀錄表")])],1),s("v-spacer"),s("v-toolbar",{attrs:{dense:""}},[s("v-text-field",{attrs:{"hide-details":"","prepend-icon":"mdi-magnify","single-line":"",label:"搜尋"},on:{keyup:function(e){return e.stopPropagation(),t.search()}},model:{value:t.serachKey,callback:function(e){t.serachKey=e},expression:"serachKey"}}),s("popupadd",{ref:"childFn",attrs:{medicationevalutionData:t.searchfilter},on:{getAllData:t.getAllData}})],1)],1),s("v-card-text",[s("v-card",{staticClass:"mt-2"},[s("v-card-text",[s("v-data-iterator",{attrs:{items:t.searchfilter,"items-per-page":t.itemsPerPage,"footer-props":{itemsPerPageOptions:t.itemsPerPageOptions}},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[s("v-simple-table",{staticClass:"mt-2 text-no-wrap",attrs:{"fixed-header":""},scopedSlots:t._u([{key:"default",fn:function(){return[s("thead",{staticStyle:{"background-color":"#e3f2fd"}},[s("tr",[s("th"),s("th",[t._v("評估日期")]),s("th",[t._v("看診科別")]),s("th",[t._v("照護藥師")]),s("th",[t._v("紀錄人")]),s("th",[t._v("修改紀錄")])])]),s("tbody",t._l(e.items,(function(e,i){return s("tr",{key:i},[s("td",[s("v-menu",{attrs:{transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[s("v-btn",t._g({attrs:{color:"primary",dark:""}},i),[t._v("功能")])]}}],null,!0)},[s("v-list",[s("v-list-item",{on:{click:function(s){return t.edit(e)}}},[s("v-list-item-title",[t._v("修改")])],1),s("v-list-item",{on:{click:function(s){return t.del(e)}}},[s("v-list-item-title",[t._v("刪除")])],1),s("v-list-item",{on:{click:function(s){return s.stopPropagation(),t.print(e)}}},[s("v-list-item-title",[t._v("列印")])],1)],1)],1)],1),s("td",[t._v(t._s(e.date))]),s("td",[t._v(t._s(e.branch))]),s("td",[t._v(t._s(e.medication?e.medication.name:"暫無資料"))]),s("td",[t._v(t._s(e.create_man))]),s("td",[t._v(t._s(e.edit_man))])])})),0)]},proxy:!0}],null,!0)})]}}])})],1)],1)],1)],1)],1)},a=[],l=(s("4de4"),s("caad"),s("d81d"),s("4e827"),s("2532"),s("1276"),s("5a0c")),n=s.n(l),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MedicationEvaluationAdd"},[s("v-dialog",{scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[s("v-icon",t._g({attrs:{color:"red lighten-2",dark:""},on:{click:t.addProcess}},i),[t._v("mdi-plus-circle")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",{class:t.titleStyle,attrs:{"primary-title":""}},[t._v(t._s(t.title))]),s("v-card-text",[s("v-form",{ref:"form",staticClass:"mt-3"},[t.userData.name?s("div",{staticClass:"grey lighten-3 pa-2 rounded"},[s("h1",[t._v("基本資料")]),s("v-divider"),s("v-row",{staticClass:"contentStyle"},[s("v-col",{attrs:{cols:"3"}},[t._v("姓名: "+t._s(t.userData.name))]),s("v-col",{attrs:{cols:"3"}},[t._v("床號: "+t._s(t.userData.bed_name))]),s("v-col",{attrs:{cols:"3"}},[t._v("年齡: "+t._s(t.returnAge(t.userData.birthday)))]),s("v-col",{attrs:{cols:"3"}},[t._v("入住日期: "+t._s(t.userData.margin_date))]),s("v-col",{attrs:{cols:"3"}},[t._v("性別: "+t._s(t.userData.sex))]),s("v-col",{attrs:{cols:"3"}},[t._v("出生日期: "+t._s(t.userData.birthday))]),s("v-col",{attrs:{cols:"3"}},[t._v("身高 / 體重: "+t._s(t.userData.height)+" / "+t._s(t.userData.weight))]),s("v-col",{attrs:{cols:"12"}},[t._v("過去病史: "+t._s(t.userData.hadadisease)+" ")]),s("v-col",{attrs:{cols:"12"}},[t._v("主要診斷: "+t._s(t.returnuDiagnosis(t.userData.diagnosis))+" ")])],1)],1):t._e(),s("v-row",[s("v-col",{attrs:{cols:"3"}},[s("v-text-field",{attrs:{type:"date",label:"訪視日期",rules:t.emptyRules},model:{value:t.list.date,callback:function(e){t.$set(t.list,"date",e)},expression:"list.date"}})],1),s("v-col",{attrs:{cols:"6"}},[s("v-text-field",{attrs:{label:"看診科別",rules:t.emptyRules},model:{value:t.list.branch,callback:function(e){t.$set(t.list,"branch",e)},expression:"list.branch"}})],1)],1),s("div",{staticClass:"grey lighten-3 pa-2 rounded"},[s("h1",[t._v("訪視項目")]),s("v-divider"),s("v-row",{staticClass:"contentStyle"},[s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"1.行動能力",items:t.visit1Items},model:{value:t.list.visit1,callback:function(e){t.$set(t.list,"visit1",e)},expression:"list.visit1"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"2.目前是否正常用藥物治療",items:t.ynItems},model:{value:t.list.visit2,callback:function(e){t.$set(t.list,"visit2",e)},expression:"list.visit2"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"3.意識是否清醒",items:t.ynItems},model:{value:t.list.visit3,callback:function(e){t.$set(t.list,"visit3",e)},expression:"list.visit3"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"4.藥歷(藥袋)及內容物是否完整",items:t.ynItems},model:{value:t.list.visit4,callback:function(e){t.$set(t.list,"visit4",e)},expression:"list.visit4"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"5.是否自行服藥",items:t.visit5Items},model:{value:t.list.visit5,callback:function(e){t.$set(t.list,"visit5",e)},expression:"list.visit5"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"6.是否按時服藥",items:t.ynItems},model:{value:t.list.visit6,callback:function(e){t.$set(t.list,"visit6",e)},expression:"list.visit6"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"7.是否有使用非口服藥品",items:t.ynItems},model:{value:t.list.visit7,callback:function(e){t.$set(t.list,"visit7",e)},expression:"list.visit7"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"8.藥品保存狀況",items:t.visit8Items},model:{value:t.list.visit8,callback:function(e){t.$set(t.list,"visit8",e)},expression:"list.visit8"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"9.是否同時服用其他非處方藥物或健康食品",items:t.ynItems},model:{value:t.list.visit9,callback:function(e){t.$set(t.list,"visit9",e)},expression:"list.visit9"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"10.是否出現藥物不良反應",items:t.visit10Items},model:{value:t.list.visit10,callback:function(e){t.$set(t.list,"visit10",e)},expression:"list.visit10"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"11.治療狀況",items:t.visit11Items},model:{value:t.list.visit11,callback:function(e){t.$set(t.list,"visit11",e)},expression:"list.visit11"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"12.建議定期檢查項目",items:t.ynItems},model:{value:t.list.visit12,callback:function(e){t.$set(t.list,"visit12",e)},expression:"list.visit12"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"13.建議定期檢查項目",items:t.ynItems},model:{value:t.list.visit13,callback:function(e){t.$set(t.list,"visit13",e)},expression:"list.visit13"}})],1),s("v-col",{attrs:{cols:"9"}},[s("v-text-field",{attrs:{label:"14.其他"},model:{value:t.list.visit14,callback:function(e){t.$set(t.list,"visit14",e)},expression:"list.visit14"}})],1)],1)],1),s("div",{staticClass:"grey lighten-3 pa-2 rounded my-2"},[s("h1",[t._v("用藥評估")]),s("v-divider"),s("v-row",{staticClass:"contentStyle"},[s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"1.處方不清楚",items:t.evaluation1Items,multiple:""},model:{value:t.list.evaluation1,callback:function(e){t.$set(t.list,"evaluation1",e)},expression:"list.evaluation1"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"2.藥物種類",items:t.evaluation2Items},model:{value:t.list.evaluation2,callback:function(e){t.$set(t.list,"evaluation2",e)},expression:"list.evaluation2"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"3.副作用",items:t.evaluation3Items,multiple:""},model:{value:t.list.evaluation3,callback:function(e){t.$set(t.list,"evaluation3",e)},expression:"list.evaluation3"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"4.藥品重覆使用",items:t.evaluation4Items,multiple:""},model:{value:t.list.evaluation4,callback:function(e){t.$set(t.list,"evaluation4",e)},expression:"list.evaluation4"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"5.藥品交互作用",items:t.ynItems},model:{value:t.list.evaluation5,callback:function(e){t.$set(t.list,"evaluation5",e)},expression:"list.evaluation5"}})],1),s("v-col",{attrs:{cols:"3"}},[s("v-select",{attrs:{label:"6.下次訪視項目",items:t.evaluation6Items,multiple:""},model:{value:t.list.evaluation6,callback:function(e){t.$set(t.list,"evaluation6",e)},expression:"list.evaluation6"}})],1)],1)],1),t.checkAllNeedDataOK?s("div",{staticClass:"grey lighten-3 pa-2 rounded my-2"},[s("h1",[t._v("藥物諮詢指導紀錄")]),s("v-divider"),t._l(t.returnMedicalArr(),(function(e){return s("div",{key:e,staticClass:"my-3"},[s("h2",{staticClass:"mb-1 d-flex justify-end"},[t._v(" 處方日: "),t.filterMatchMedical(e)[0].medicalData?s("div",[t._v(" "+t._s(t.filterMatchMedical(e)[0].medicalData.date)+" "+t._s(t.filterMatchMedical(e)[0].medicalData.hospital_name)+"-"+t._s(t.filterMatchMedical(e)[0].medicalData.branch_name)+" 醫師: "+t._s(t.filterMatchMedical(e)[0].medicalData.doctor_name)+" ")]):s("div",{staticClass:"red--text"},[t._v("無符合資料")])]),s("v-simple-table",[s("thead",[s("tr",[s("th",[t._v("用藥日期")]),s("th",[t._v("藥名")]),s("th",[t._v("次量")]),s("th",[t._v("頻率")]),s("th",[t._v("途徑")]),s("th",[t._v("天數")]),s("th",[t._v("總量")])])]),s("tbody",t._l(t.filterMatchMedical(e),(function(e){return s("tr",{key:e.snkey},[s("td",[t._v(t._s(e.start_date))]),s("td",[t._v(t._s(e.name)+" "+t._s(e.dosage))]),s("td",[t._v(t._s(e.quantity)+" "+t._s(e.unit_name))]),s("td",[t._v(t._s(e.eat_medicine_timeData?e.eat_medicine_timeData.name:"未指定給藥時間"))]),s("td",[t._v(t._s(e.method_name))]),s("td",[e.eat_medicine_timeData?s("span",[t._v(" "+t._s(isNaN(e.quantity)?e.quantity:(e.medicine_counts/t.returnMathFromStr(e.quantity)/e.eat_medicine_timeData.time.split(",").length/e.eat_medicine_timeData.day).toFixed(0))+" ")]):s("span",[t._v("未指定給藥時間")])]),s("td",[t._v(t._s(e.medicine_counts))])])})),0)])],1)})),s("v-divider",{staticClass:"my-4"}),s("v-textarea",{attrs:{label:"藥師建議事項",outlined:"","auto-grow":""},model:{value:t.list.pharmacistSuggest,callback:function(e){t.$set(t.list,"pharmacistSuggest",e)},expression:"list.pharmacistSuggest"}}),s("v-textarea",{attrs:{label:"處方醫師及機構主護回覆說明",outlined:"","auto-grow":""},model:{value:t.list.nursingSuggest,callback:function(e){t.$set(t.list,"nursingSuggest",e)},expression:"list.nursingSuggest"}})],2):t._e(),s("div",{staticClass:"grey lighten-3 pa-2 rounded my-2"},[s("div",{staticClass:"d-flex justify-space-between align-center"},[s("h1",[t._v("照護藥師選擇")]),s("v-select",{staticClass:"mx-5",attrs:{items:t.medicationItems,label:"選擇藥師資料",rules:t.emptyRules,"hide-details":"","return-object":""},model:{value:t.list.medication,callback:function(e){t.$set(t.list,"medication",e)},expression:"list.medication"}}),s("MedicationList")],1),s("v-divider"),t.list.medication?s("div",[s("h2",[t._v("照護藥師資料")]),s("v-row",{staticClass:"contentStyle"},[s("v-col",{attrs:{cols:"4"}},[t._v(" 姓名: "+t._s(t.list.medication.name)+" ")]),s("v-col",{attrs:{cols:"4"}},[t._v(" 電話: "+t._s(t.list.medication.tel)+" ")]),s("v-col",{attrs:{cols:"4"}},[t._v(" 藥師證號: "+t._s(t.list.medication.license)+" ")]),s("v-col",{attrs:{cols:"5"}},[t._v(" 藥局名稱: "+t._s(t.list.medication.pharmacyName)+" ")]),s("v-col",{attrs:{cols:"7"}},[t._v(" 地址: "+t._s(t.list.medication.address)+" ")])],1)],1):t._e()],1)],1)],1),s("v-divider"),s("v-card-actions",[s("v-spacer"),"add"==t.processType?s("v-btn",{staticClass:"primary",attrs:{loading:t.loading,disabled:t.loading},on:{click:t.addOK}},[t._v("確認新增")]):t._e(),"edit"==t.processType?s("v-btn",{staticClass:"success",attrs:{loading:t.loading,disabled:t.loading},on:{click:t.editOK}},[t._v("確認修改")]):t._e()],1)],1)],1)],1)},o=[],c=(s("a4d3"),s("99af"),s("7db0"),s("fb6a"),s("b0c0"),s("e439"),s("dbb4"),s("b64b"),s("d3b7"),s("07ac"),s("25f0"),s("6062"),s("3ca3"),s("159b"),s("ddb0"),s("2909")),d=s("ade3"),u=s("b7ad"),v=s("e418"),m=s.n(v),f=s("cb71");function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){Object(d["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}n.a.extend(m.a);var _={props:["medicationevalutionData"],components:{MedicationList:u["a"]},data:function(){return{dialog:!1,list:{},processType:"",title:"",titleStyle:"",emptyRules:[function(t){return!!t||"不可空白"}],loading:!1,ynItems:["","是","否"],visit1Items:["","獨立行走","長期臥床","輪椅助行","使用其他輔助具"],visit5Items:["","是","否","部分依賴他人","完全依賴他人"],visit8Items:["","佳","尚可","需改進"],visit10Items:["","是(接ADR)","否"],visit11Items:["","改善(穩定)","無改善(不穩定)","時好時壞","不清楚"],evaluation1Items:["無","劑量","給藥途徑","藥物錯誤","用法不當","給藥次數","藥品劑量"],evaluation2Items:["","適量","過高","過低"],evaluation3Items:["無","有","胃腸不適","腹瀉","咳嗽","暈眩","其他"],evaluation4Items:["無","相同成份","相同類別","相同療效"],evaluation6Items:["定期回診","檢查項目是否正常","持續監測血壓","持續監測血糖","持續監測血脂"],userMedicineItems:null,userMedicalRecordItems:null,eat_medicine_timeItems:null}},computed:{checkAllNeedDataOK:function(){return null!=this.userMedicineItems&&null!=this.userMedicalRecordItems&&null!=this.eat_medicine_timeItems},userData:function(){return this.$store.state.uData},medicationItems:function(){return this.$store.state.medicationItems.map((function(t){var e=JSON.parse(t.datalist);return h({},e,{text:"".concat(e.name," / ").concat(e.license," / ").concat(e.pharmacyName)})}))},buildMatchDayMedicines:function(){var t=this,e=this.userMedicineItems.sort((function(t,e){return t.start_date>e.start_date?1:-1})).map((function(t){return h({},t,{medicineEndDay:t.medicineEndInfo.slice(3,13)})}));return e=e.filter((function(e){return n()(e.medicineEndDay).isBetween(n()(t.list.date).add(-90,"day"),n()(t.list.date),null,"[]")})),e=e.map((function(e){return h({},e,{medicalData:t.returnMedicalData(e),eat_medicine_timeData:t.returnEatMedicineTime(e)})})),e}},mounted:function(){this.$store.dispatch("getItems","medication"),this.getUserMedicine(),this.getUserMedicalRecord(),this.getItems("eat_medicine_time")},methods:{returnMedicalArr:function(){var t=this.buildMatchDayMedicines.map((function(t){return t.medical_snkey}));return t=new Set(t),t=Object(c["a"])(t),t},filterMatchMedical:function(t){return this.buildMatchDayMedicines.filter((function(e){return e.medical_snkey==t}))},returnMedicalData:function(t){return this.userMedicalRecordItems.find((function(e){return e.snkey==t.medical_snkey}))},returnEatMedicineTime:function(t){return this.eat_medicine_timeItems.find((function(e){return e.snkey==t.eat_medicine_time_snkey}))},returnMathFromStr:function(t){return f["a"](t)},getUserMedicine:function(){var t=this,e={key:"user_snkey",value:this.$store.state.uData.snkey};this.$api.options("medicinerecord/getByKey/"+this.$store.state.databaseName,e).then((function(e){t.userMedicineItems=e}))},getUserMedicalRecord:function(){var t=this;this.$api.options("medicinerecord/getByUserSnkey/"+this.$store.state.databaseName+"/"+this.$store.state.uData.snkey).then((function(e){t.userMedicalRecordItems=e}))},getItems:function(t){var e=this;this.$api.options("general/getAll/"+this.$store.state.databaseName+"/"+t).then((function(s){e[t+"Items"]=s}))},returnuDiagnosis:function(t){var e=Object.values(t);return e.toString()},returnAge:function(t){return n()().format("YYYY")-n()(t).format("YYYY")},addProcess:function(){var t=this;this.processType="add",this.title="新增資料",this.titleStyle="font-weight-black error lighten-2",0!=this.medicationevalutionData.length?(this.list=JSON.parse(JSON.stringify(this.medicationevalutionData[0])),this.list.date=n()().format("YYYY-MM-DD")):this.list={date:n()().format("YYYY-MM-DD")},this.$nextTick((function(){t.$refs.form.resetValidation()}))},editProcess:function(t){console.log(t),this.processType="edit",this.title="修改資料",this.titleStyle="font-weight-black success lighten-2",this.list=JSON.parse(JSON.stringify(t)),this.dialog=!0},addOK:function(){var t=this;if(this.$refs.form.validate()){this.list.user_snkey=this.$store.state.uData.snkey,this.list.create_man=this.$store.state.pData.username+"("+n()().format("YYYY-MM-DD HH:mm:ss")+")";var e={user_snkey:this.$store.state.uData.snkey,datalist:JSON.stringify(this.list)};this.loading=!0,this.$api.options("general/add/"+this.$store.state.databaseName+"/medicationevalution",e).then((function(e){if(1==e.state){var s={msg:"已新增",type:!0,theme:"success"};t.$store.commit("snackbar",s),t.dialog=!1,t.$emit("getAllData"),t.loading=!1}}))}else{var s={msg:"資料輸入不完全!!請重新確認!!",type:!0,theme:"warning"};this.$store.commit("snackbar",s)}},editOK:function(){var t=this;if(this.$refs.form.validate()){this.list.edit_man||(this.list.edit_man=""),this.list.edit_man=this.$store.state.pData.username+"("+n()().format("YYYY-MM-DD HH:mm:ss")+")"+this.list.edit_man;var e={snkey:this.list.snkey,datalist:JSON.stringify(this.list),edit_man:""};this.loading=!0,this.$api.options("general/edit/"+this.$store.state.databaseName+"/medicationevalution",e).then((function(e){if(1==e.state){var s={msg:"已修改",type:!0,theme:"success"};t.$store.commit("snackbar",s),t.dialog=!1,t.loading=!1,t.$emit("getAllData")}}))}else{var s={msg:"資料輸入不完全!!請重新確認!!",type:!0,theme:"warning"};this.$store.commit("snackbar",s)}}}},b=_,y=(s("0dc9"),s("2877")),g=s("6544"),k=s.n(g),$=s("8336"),D=s("b0af"),x=s("99d9"),M=s("62ad"),O=s("169a"),I=s("ce7e"),S=s("4bd4"),C=s("132d"),V=s("0fd9"),P=s("b974"),w=s("1f4f"),Y=s("2fa4"),N=s("8654"),j=s("a844"),T=Object(y["a"])(b,r,o,!1,null,"29ad8729",null),A=T.exports;k()(T,{VBtn:$["a"],VCard:D["a"],VCardActions:x["b"],VCardText:x["d"],VCardTitle:x["e"],VCol:M["a"],VDialog:O["a"],VDivider:I["a"],VForm:S["a"],VIcon:C["a"],VRow:V["a"],VSelect:P["a"],VSimpleTable:w["a"],VSpacer:Y["a"],VTextField:N["a"],VTextarea:j["a"]});var R={components:{popupadd:A},data:function(){return{items:[],serachKey:"",itemsPerPageOptions:[10,20,30],itemsPerPage:10}},computed:{searchfilter:function(){var t=this.serachKey.split(" "),e="";return t.reduce((function(t,s){return t.filter((function(t){if(e=JSON.stringify(t).toUpperCase(),e.includes(s.toUpperCase()))return t}))}),this.items)}},mounted:function(){this.getAllData()},methods:{print:function(t){var e={list:t,userData:this.$store.state.uData},s=this.$router.resolve({path:"/print/MedicationEvaluationPrint",query:{data:JSON.stringify(e)}});window.open(s.href,"_blank")},getAllData:function(){var t=this,e={key:"user_snkey",value:this.$store.state.uData.snkey};this.$api.options("general/getByKey/"+this.$store.state.databaseName+"/medicationevalution",e).then((function(e){t.items=e.map((function(t){var e=JSON.parse(t.datalist);return e["snkey"]=t.snkey,e})).sort((function(t,e){return t.date<e.date?1:-1}))}))},edit:function(t){this.$refs.childFn.editProcess(t)},del:function(t){var e=this;this.$confirm("確認刪除?").then((function(s){t.delman=e.$store.state.pData.username+"("+n()().format("YYYY-MM-DD HH:mm:ss")+")";var i={snkey:t.snkey,tablename:"medicationevalution",info:JSON.stringify(t)};s&&e.$api.options("general/delv3/"+e.$store.state.databaseName+"/"+i.tablename,i).then((function(t){if(1==t.state){var s={msg:"已刪除",type:!0,theme:"success"};e.$store.commit("snackbar",s),e.getAllData()}}))}))}}},J=R,K=(s("2792"),s("c377")),E=s("8860"),H=s("da13"),F=s("5d23"),B=s("e449"),L=s("71d9"),U=Object(y["a"])(J,i,a,!1,null,"6ac20231",null);e["default"]=U.exports;k()(U,{VBtn:$["a"],VCard:D["a"],VCardText:x["d"],VCardTitle:x["e"],VDataIterator:K["a"],VIcon:C["a"],VList:E["a"],VListItem:H["a"],VListItemTitle:F["k"],VMenu:B["a"],VSimpleTable:w["a"],VSpacer:Y["a"],VTextField:N["a"],VToolbar:L["a"]})},d243:function(t,e,s){},df74:function(t,e,s){}}]);
//# sourceMappingURL=chunk-e6c71286.e94bd119.js.map