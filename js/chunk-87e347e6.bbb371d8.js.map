{"version":3,"sources":["webpack:///./src/views/document/PharmacistEvaluationList.vue?c73f","webpack:///src/views/document/PharmacistEvaluationList.vue","webpack:///./src/views/document/PharmacistEvaluationList.vue?072c","webpack:///./src/views/document/PharmacistEvaluationList.vue","webpack:///./src/views/document/PharmacistEvaluationList.vue?a14b"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$store","state","uData","p_code","userData","bed_name","name","ref","attrs","emptyRules","model","value","list","callback","$$v","$set","expression","birthday","sex","in_date","returnuDiagnosis","diagnosis","activeItems","spCareItems","medicineRelyItems","allergyhistory2","length","allergyhistory4","allergyhistory5","_e","_l","returnMedicalArr","medical_snkey","key","snkey","filterMatchMedical","medicalData","hospital_name","branch_name","doctor_name","item","start_date","dosage","quantity","unit_name","eat_medicine_timeData","method_name","isNaN","medicine_counts","returnMathFromStr","time","split","day","toFixed","on","$event","stopPropagation","print","editOK","staticRenderFns","data","processModel","date","userMedicineItems","userMedicalRecordItems","eat_medicine_timeItems","computed","checkAllNeedDataOK","buildMatchDayMedicines","medicineEndDay","i","medicineEndInfo","slice","newMedicineItems","filter","map","mounted","getUserMedicine","getUserMedicalRecord","getItems","getExistData","methods","path","query","window","open","routeData","href","$api","options","rs","$refs","form","validate","console","log","user_snkey","create_man","url","postData","datalist","JSON","stringify","msg","edit_man","then","pop","type","theme","commit","newItems","Set","returnMedicalData","find","returnEatMedicineTime","values","forEach","index","str","component","VBtn","VCard","VCardActions","VCardText","VCardTitle","VCol","VDivider","VForm","VIcon","VRow","VSelect","VSimpleTable","VSpacer","VTextField","VTextarea"],"mappings":"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","file":"js/chunk-87e347e6.bbb371d8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"PharmacistEvaluationList\"},[_c('v-card',{staticClass:\"mt-2 mb-6 pb-6\"},[_c('v-card-title',{staticClass:\"d-flex justify-space-between align-center\"},[_c('h2',[_c('v-icon',{staticClass:\"mr-2\"},[_vm._v(\"fas fa-file-alt\")]),_c('span',[_vm._v(\"72小時藥師評估表\")])],1),_c('h2',[_vm._v(\" \"+_vm._s(this.$store.state.uData.p_code)+\" / \"+_vm._s(_vm.userData.bed_name)+\" / \"+_vm._s(this.$store.state.uData.name)+\" \")])]),(_vm.checkAllNeedDataOK)?_c('v-card-text',[_c('v-form',{ref:\"form\"},[_c('v-text-field',{attrs:{\"type\":\"date\",\"label\":\"評估日期\",\"rules\":_vm.emptyRules},model:{value:(_vm.list.date),callback:function ($$v) {_vm.$set(_vm.list, \"date\", $$v)},expression:\"list.date\"}}),_c('div',{staticClass:\"grey lighten-3 pa-2 rounded\"},[_c('h1',[_vm._v(\"基本資料\")]),_c('v-divider'),_c('v-row',{staticClass:\"contentStyle\"},[_c('v-col',{attrs:{\"cols\":\"3\"}},[_vm._v(\"姓名: \"+_vm._s(_vm.userData.name)+\" \")]),_c('v-col',{attrs:{\"cols\":\"3\"}},[_vm._v(\"床號: \"+_vm._s(_vm.userData.bed_name)+\" \")]),_c('v-col',{attrs:{\"cols\":\"3\"}},[_vm._v(\"出生日期: \"+_vm._s(_vm.userData.birthday))]),_c('v-col',{attrs:{\"cols\":\"3\"}},[_vm._v(\"性別: \"+_vm._s(_vm.userData.sex))]),_c('v-col',{attrs:{\"cols\":\"3\"}},[_vm._v(\"入住日期: \"+_vm._s(_vm.userData.in_date))]),_c('v-col',{attrs:{\"cols\":\"8\"}},[_vm._v(\"過去病史: \"+_vm._s(_vm.returnuDiagnosis(_vm.userData.diagnosis))+\" \")])],1)],1),_c('div',{staticClass:\"grey lighten-3 pa-2 rounded my-2\"},[_c('h1',[_vm._v(\"生理狀況\")]),_c('v-divider'),_c('v-row',{staticClass:\"contentStyle\"},[_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-select',{attrs:{\"label\":\"行動能力\",\"items\":_vm.activeItems},model:{value:(_vm.list.active),callback:function ($$v) {_vm.$set(_vm.list, \"active\", $$v)},expression:\"list.active\"}})],1),_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-select',{attrs:{\"label\":\"特殊照護\",\"items\":_vm.spCareItems,\"multiple\":\"\"},model:{value:(_vm.list.spCare),callback:function ($$v) {_vm.$set(_vm.list, \"spCare\", $$v)},expression:\"list.spCare\"}})],1),_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-select',{attrs:{\"label\":\"藥物依賴\",\"items\":_vm.medicineRelyItems,\"multiple\":\"\"},model:{value:(_vm.list.medicineRely),callback:function ($$v) {_vm.$set(_vm.list, \"medicineRely\", $$v)},expression:\"list.medicineRely\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\"}},[_vm._v(\" 過敏史: \"),(\n                  !(\n                    _vm.userData.allergyhistory2.length +\n                    _vm.userData.allergyhistory4.length +\n                    _vm.userData.allergyhistory5.length\n                  )\n                )?_c('span',[_vm._v(\"無\")]):_vm._e(),_vm._v(\" \"+_vm._s(_vm.userData.allergyhistory2)+\" \"+_vm._s(_vm.userData.allergyhistory4)+\" \"+_vm._s(_vm.userData.allergyhistory5)+\" \")])],1)],1),_c('div',{staticClass:\"grey lighten-3 pa-2 rounded my-2\"},[_c('h1',[_vm._v(\"服用藥物\")]),_c('v-divider'),_vm._l((_vm.returnMedicalArr()),function(medical_snkey){return _c('div',{key:medical_snkey.snkey,staticClass:\"my-3\"},[_c('h2',{staticClass:\"text-right mb-1\"},[_vm._v(\" \"+_vm._s(_vm.filterMatchMedical(medical_snkey)[0].medicalData .hospital_name)+\"-\"+_vm._s(_vm.filterMatchMedical(medical_snkey)[0].medicalData.branch_name)+\" 醫師: \"+_vm._s(_vm.filterMatchMedical(medical_snkey)[0].medicalData.doctor_name)+\" \")]),_c('v-simple-table',[_c('thead',[_c('tr',[_c('th',[_vm._v(\"用藥日期\")]),_c('th',[_vm._v(\"藥名\")]),_c('th',[_vm._v(\"次量\")]),_c('th',[_vm._v(\"頻率\")]),_c('th',[_vm._v(\"途徑\")]),_c('th',[_vm._v(\"天數\")]),_c('th',[_vm._v(\"總量\")])])]),_c('tbody',_vm._l((_vm.filterMatchMedical(medical_snkey)),function(item){return _c('tr',{key:item.snkey},[_c('td',[_vm._v(_vm._s(item.start_date))]),_c('td',[_vm._v(_vm._s(item.name)+\" \"+_vm._s(item.dosage))]),_c('td',[_vm._v(_vm._s(item.quantity)+\" \"+_vm._s(item.unit_name))]),_c('td',[_vm._v(_vm._s(item.eat_medicine_timeData ? item.eat_medicine_timeData.name : '無資料'))]),_c('td',[_vm._v(_vm._s(item.method_name))]),_c('td',[(item.eat_medicine_timeData)?_c('span',[_vm._v(\" \"+_vm._s(isNaN(item.quantity) ? item.quantity : ((item.medicine_counts / _vm.returnMathFromStr(item.quantity) / item.eat_medicine_timeData.time.split(\",\").length / item.eat_medicine_timeData.day)*100).toFixed(0)/100)+\" \")]):_vm._e()]),_c('td',[_vm._v(_vm._s(item.medicine_counts))])])}),0)])],1)})],2),_c('v-textarea',{attrs:{\"label\":\"藥師建議\",\"outlined\":\"\",\"auto-grow\":\"\"},model:{value:(_vm.list.pharmacistSuggest),callback:function ($$v) {_vm.$set(_vm.list, \"pharmacistSuggest\", $$v)},expression:\"list.pharmacistSuggest\"}}),_c('v-textarea',{attrs:{\"label\":\"機構護理人員回覆\",\"outlined\":\"\",\"auto-grow\":\"\"},model:{value:(_vm.list.nursingSuggest),callback:function ($$v) {_vm.$set(_vm.list, \"nursingSuggest\", $$v)},expression:\"list.nursingSuggest\"}})],1)],1):_vm._e(),_c('v-divider'),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{staticClass:\"primary\",on:{\"click\":function($event){$event.stopPropagation();return _vm.print($event)}}},[_vm._v(\" 資料列印 \"),_c('v-icon',{staticClass:\"ml-1\"},[_vm._v(\"mdi-printer\")])],1),_c('v-btn',{staticClass:\"success\",on:{\"click\":function($event){$event.stopPropagation();return _vm.editOK($event)}}},[_vm._v(\"資料更新\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"PharmacistEvaluationList\">\r\n    <v-card class=\"mt-2 mb-6 pb-6\">\r\n      <v-card-title class=\"d-flex justify-space-between align-center\">\r\n        <!-- <h2 class=\"grey--text\"> -->\r\n          <h2>\r\n            <v-icon class=\"mr-2\">fas fa-file-alt</v-icon>\r\n            <span>72小時藥師評估表</span>\r\n          </h2>\r\n          \r\n          <h2>\r\n            {{ this.$store.state.uData.p_code }} /\r\n            {{ userData.bed_name }} /\r\n            {{ this.$store.state.uData.name }}\r\n          </h2>\r\n          \r\n        <!-- </h2> -->\r\n      </v-card-title>\r\n\r\n      <v-card-text v-if=\"checkAllNeedDataOK\">\r\n        <v-form ref=\"form\">\r\n          <v-text-field\r\n            type=\"date\"\r\n            label=\"評估日期\"\r\n            v-model=\"list.date\"\r\n            :rules=\"emptyRules\"\r\n          ></v-text-field>\r\n\r\n          <div class=\"grey lighten-3 pa-2 rounded\">\r\n            <h1>基本資料</h1>\r\n            <v-divider></v-divider>\r\n            <v-row class=\"contentStyle\">\r\n              <v-col cols=\"3\">姓名: {{ userData.name }} </v-col>\r\n              <v-col cols=\"3\">床號: {{ userData.bed_name }} </v-col>\r\n              <v-col cols=\"3\">出生日期: {{ userData.birthday }}</v-col>\r\n              <v-col cols=\"3\">性別: {{ userData.sex }}</v-col>\r\n              <v-col cols=\"3\">入住日期: {{ userData.in_date }}</v-col>\r\n              <v-col cols=\"8\"\r\n                >過去病史: {{ returnuDiagnosis(userData.diagnosis) }}\r\n              </v-col>\r\n            </v-row>\r\n          </div>\r\n\r\n          <div class=\"grey lighten-3 pa-2 rounded my-2\">\r\n            <h1>生理狀況</h1>\r\n            <v-divider></v-divider>\r\n            <v-row class=\"contentStyle\">\r\n              <v-col cols=\"4\">\r\n                <v-select\r\n                  label=\"行動能力\"\r\n                  :items=\"activeItems\"\r\n                  v-model=\"list.active\"\r\n                ></v-select>\r\n              </v-col>\r\n              <v-col cols=\"4\">\r\n                <v-select\r\n                  label=\"特殊照護\"\r\n                  :items=\"spCareItems\"\r\n                  v-model=\"list.spCare\"\r\n                  multiple\r\n                ></v-select>\r\n              </v-col>\r\n              <v-col cols=\"4\">\r\n                <v-select\r\n                  label=\"藥物依賴\"\r\n                  :items=\"medicineRelyItems\"\r\n                  v-model=\"list.medicineRely\"\r\n                  multiple\r\n                ></v-select>\r\n              </v-col>\r\n              <v-col cols=\"12\">\r\n                過敏史:\r\n                <span\r\n                  v-if=\"\r\n                    !(\r\n                      userData.allergyhistory2.length +\r\n                      userData.allergyhistory4.length +\r\n                      userData.allergyhistory5.length\r\n                    )\r\n                  \"\r\n                  >無</span\r\n                >\r\n                {{ userData.allergyhistory2 }} {{ userData.allergyhistory4 }}\r\n                {{ userData.allergyhistory5 }}\r\n              </v-col>\r\n            </v-row>\r\n          </div>\r\n\r\n          <div class=\"grey lighten-3 pa-2 rounded my-2\">\r\n            <h1>服用藥物</h1>\r\n            <v-divider></v-divider>\r\n            <div\r\n              v-for=\"medical_snkey in returnMedicalArr()\"\r\n              :key=\"medical_snkey.snkey\"\r\n              class=\"my-3\"\r\n            >\r\n              <h2 class=\"text-right mb-1\">\r\n                {{\r\n                  filterMatchMedical(medical_snkey)[0].medicalData\r\n                    .hospital_name\r\n                }}-{{\r\n                  filterMatchMedical(medical_snkey)[0].medicalData.branch_name\r\n                }}\r\n                醫師:\r\n                {{\r\n                  filterMatchMedical(medical_snkey)[0].medicalData.doctor_name\r\n                }}\r\n              </h2>\r\n\r\n              <v-simple-table>\r\n                <thead>\r\n                  <tr>\r\n                    <th>用藥日期</th>\r\n                    <th>藥名</th>\r\n                    <th>次量</th>\r\n                    <th>頻率</th>\r\n                    <th>途徑</th>\r\n                    <th>天數</th>\r\n                    <th>總量</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr\r\n                    v-for=\"item in filterMatchMedical(medical_snkey)\"\r\n                    :key=\"item.snkey\"\r\n                  >\r\n                    <td>{{ item.start_date }}</td>\r\n                    <td>{{ item.name }} {{ item.dosage }}</td>\r\n                    <td>{{ item.quantity }} {{ item.unit_name }}</td>\r\n                    <td>{{ item.eat_medicine_timeData ? item.eat_medicine_timeData.name : '無資料' }}</td>\r\n                    <td>{{ item.method_name }}</td>\r\n                    <td>\r\n                      <span v-if=\"item.eat_medicine_timeData\">\r\n                        {{isNaN(item.quantity) \r\n                        ? item.quantity\r\n                        : ((item.medicine_counts /\r\n                          returnMathFromStr(item.quantity) /\r\n                          item.eat_medicine_timeData.time.split(\",\").length /\r\n                          item.eat_medicine_timeData.day)*100).toFixed(0)/100\r\n                        }}\r\n\r\n                      </span>\r\n                      <!-- {{\r\n                        item.medicine_counts /\r\n                        returnMathFromStr(item.quantity) /\r\n                        item.eat_medicine_timeData.time.split(\",\").length /\r\n                        item.eat_medicine_timeData.day\r\n                      }} -->\r\n                    </td>\r\n                    <td>{{ item.medicine_counts }}</td>\r\n                  </tr>\r\n                </tbody>\r\n              </v-simple-table>\r\n            </div>\r\n          </div>\r\n\r\n          <v-textarea\r\n            label=\"藥師建議\"\r\n            v-model=\"list.pharmacistSuggest\"\r\n            outlined\r\n            auto-grow\r\n          ></v-textarea>\r\n          <v-textarea\r\n            label=\"機構護理人員回覆\"\r\n            v-model=\"list.nursingSuggest\"\r\n            outlined\r\n            auto-grow\r\n          ></v-textarea>\r\n        </v-form>\r\n      </v-card-text>\r\n\r\n      <v-divider></v-divider>\r\n\r\n      <v-card-actions>\r\n        <v-spacer></v-spacer>\r\n        <v-btn class=\"primary\" @click.stop=\"print\">\r\n          資料列印\r\n          <v-icon class=\"ml-1\">mdi-printer</v-icon>\r\n        </v-btn>\r\n        <v-btn class=\"success\" @click.stop=\"editOK\">資料更新</v-btn>\r\n      </v-card-actions>\r\n    </v-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport dayjs from \"dayjs\";\r\nimport isBetween from \"dayjs/plugin/isBetween\";\r\ndayjs.extend(isBetween);\r\n\r\nimport * as math from \"mathjs\"; //引入mathjs,處理浮點相乘產生的問題\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      processModel: \"addModel\",\r\n      emptyRules: [(v) => !!v || \"不可空白\"],\r\n      list: {\r\n        date: dayjs().format(\"YYYY-MM-DD\"),\r\n      },\r\n      activeItems: [\"\", \"獨立行走\", \"長期臥床\", \"輪椅助行\", \"其他輔具\"],\r\n      spCareItems: [\"無\", \"鼻異管餵食\", \"使用導尿管\", \"使用氣切\", \"其他\"],\r\n      medicineRelyItems: [\"有\", \"無\"],\r\n      userMedicineItems: null, //住民使用藥物 -> 依 uData snkey取得\r\n      userMedicalRecordItems: null, //住民就診紀錄 -> 依 uData snkey取得\r\n      eat_medicine_timeItems: null,\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    //判斷資料是否都讀取OK\r\n    checkAllNeedDataOK(){\r\n      if (this.userMedicineItems != null && this.userMedicalRecordItems != null && this.eat_medicine_timeItems != null){\r\n        return true\r\n      }else{\r\n        return false\r\n      }\r\n    },\r\n    //住民資料\r\n    userData() {\r\n      return this.$store.state.uData;\r\n    },\r\n    //重新整理符合目前選擇日期的藥物資料 內容: 1.建構藥物結束時間 2.選擇的日期在藥物使用區間內 3.拚出就醫資料,藥物資料 4.拚出用藥頻率\r\n    buildMatchDayMedicines() {\r\n      //1.\r\n      let newMedicineItems = this.userMedicineItems.map((i) => {\r\n        return {\r\n          ...i,\r\n          medicineEndDay: i.medicineEndInfo.slice(3, 13),\r\n        };\r\n      });\r\n\r\n      //2.\r\n      newMedicineItems = newMedicineItems.filter((i) =>\r\n        dayjs(this.list.date).isBetween(\r\n          i.start_date,\r\n          dayjs(i.medicineEndDay),\r\n          null,\r\n          \"[]\"\r\n        )\r\n      );\r\n\r\n      //3. 4.\r\n      newMedicineItems = newMedicineItems.map((i) => {\r\n        return {\r\n          ...i,\r\n          medicalData: this.returnMedicalData(i),\r\n          eat_medicine_timeData: this.returnEatMedicineTime(i),\r\n        };\r\n      });\r\n\r\n      return newMedicineItems;\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    this.getUserMedicine(); //取得住民使用藥物\r\n    this.getUserMedicalRecord(); //取得住民就診紀錄\r\n    this.getItems(\"eat_medicine_time\"); //取得用藥\r\n    this.getExistData();\r\n  },\r\n\r\n  methods: {\r\n    //列印功能\r\n    print() {\r\n      let postData = {\r\n        list : this.list,\r\n        userData : this.userData,\r\n      }\r\n      let routeData = this.$router.resolve({\r\n        path: \"/print/PharmacistEvaluationListPrint\",\r\n        query: { data: JSON.stringify(postData) },\r\n      });\r\n      window.open(routeData.href, \"_blank\");\r\n    },\r\n    //如果已存在資料,就顯示在列表裡 -> 判斷資料是否未新增的意思\r\n    getExistData() {\r\n      let getData = {\r\n        key: \"user_snkey\",\r\n        value: this.$store.state.uData.snkey,\r\n      };\r\n      this.$api.options(\r\n        \"general/getByKey/\" +\r\n          this.$store.state.databaseName +\r\n          \"/pharmacistevalution\",\r\n        getData\r\n      ).then((rs) => {\r\n        if (rs.length) {\r\n          let newItem = rs[0];\r\n          this.list = JSON.parse(newItem.datalist);\r\n          this.list.snkey = newItem.snkey;\r\n          this.processModel = 'editModel'\r\n        }\r\n      });\r\n    },\r\n    //資料更新確認 -> 確認資料存在 -> 更新; 不存在-> 新增\r\n    editOK() {\r\n      if (this.$refs.form.validate()) {\r\n        if (this.processModel == \"addModel\") {\r\n          console.log(\"add\");\r\n          this.list.user_snkey = this.$store.state.uData.snkey;\r\n          this.list.create_man =\r\n            this.$store.state.pData.username +\r\n            \"(\" +\r\n            dayjs().format(\"YYYY-MM-DD HH:mm:ss\") +\r\n            \")\"; //執行動作的人,時間,內容\r\n          var url =\r\n            \"general/add/\" +\r\n            this.$store.state.databaseName +\r\n            \"/pharmacistevalution\";\r\n          var postData = {\r\n            user_snkey: this.$store.state.uData.snkey,\r\n            datalist: JSON.stringify(this.list),\r\n          };\r\n          var msg = \"資料新增\";\r\n        } else {\r\n          console.log(\"edit\");\r\n          if (!this.list.edit_man) {\r\n            this.list.edit_man = \"\";\r\n          }\r\n          this.list.edit_man =\r\n            this.$store.state.pData.username +\r\n            \"(\" +\r\n            dayjs().format(\"YYYY-MM-DD HH:mm:ss\") +\r\n            \")\" +\r\n            this.list.edit_man; //執行動作的人,時間,內容\r\n          var url =\r\n            \"general/edit/\" +\r\n            this.$store.state.databaseName +\r\n            \"/pharmacistevalution\";\r\n          var postData = {\r\n            snkey: this.list.snkey,\r\n            datalist: JSON.stringify(this.list),\r\n            edit_man: \"\",\r\n          };\r\n          var msg = \"資料已更新\";\r\n        }\r\n\r\n        this.$api.options(url, postData).then((rs) => {\r\n          if (rs.state == 1) {\r\n            var pop = { msg: msg, type: true, theme: \"success\" };\r\n            this.$store.commit(\"snackbar\", pop);\r\n            this.$emit(\"getAllData\");\r\n          } else {\r\n            console.log(rs);\r\n            var pop = { msg: \"error\", type: true, theme: \"error\" };\r\n            this.$store.commit(\"snackbar\", pop);\r\n          }\r\n        });\r\n      } else {\r\n        var pop = {\r\n          msg: \"資料輸入不完整,請再確認!!\",\r\n          type: true,\r\n          theme: \"warning\",\r\n        };\r\n        this.$store.commit(\"snackbar\", pop);\r\n      }\r\n    },\r\n    //如果內容是字串型的運算式時.透過這個去計算\r\n    returnMathFromStr(val) {\r\n      return math.evaluate(val);\r\n      // math.derivative('1/4')\r\n    },\r\n    //回傳指定就診資料\r\n    filterMatchMedical(snkey) {\r\n      return this.buildMatchDayMedicines.filter(\r\n        (i) => i.medical_snkey == snkey\r\n      );\r\n    },\r\n    //回傳就診的陣列\r\n    returnMedicalArr() {\r\n      let newItems = this.buildMatchDayMedicines.map((i) => i.medical_snkey);\r\n      newItems = new Set(newItems);\r\n      newItems = [...newItems];\r\n      return newItems;\r\n    },\r\n    //回傳指定藥物的就診紀錄資料\r\n    returnMedicalData(item) {\r\n      return this.userMedicalRecordItems.find(\r\n        (i) => i.snkey == item.medical_snkey\r\n      );\r\n    },\r\n    //回傳指定藥物的用藥頻率資料\r\n    returnEatMedicineTime(item) {\r\n      return this.eat_medicine_timeItems.find(\r\n        (i) => i.snkey == item.eat_medicine_time_snkey\r\n      );\r\n    },\r\n    //取得住民使用藥物\r\n    getUserMedicine() {\r\n      var postData = {\r\n        key: \"user_snkey\",\r\n        value: this.$store.state.uData.snkey,\r\n      };\r\n      this.$api.options(\r\n        //\"general/getByKey/\" + this.$store.state.databaseName + \"/medicine_record\",\r\n        \"medicinerecord/getByKey/\" + this.$store.state.databaseName,\r\n        postData\r\n      ).then((rs) => {\r\n        this.userMedicineItems = rs;\r\n      });\r\n    },\r\n    //取得住民就醫紀錄\r\n    getUserMedicalRecord() {\r\n      this.$api.options(\r\n        \"medicinerecord/getByUserSnkey/\" +\r\n          this.$store.state.databaseName +\r\n          \"/\" +\r\n          this.$store.state.uData.snkey\r\n      ).then((rs) => {\r\n        this.userMedicalRecordItems = rs;\r\n      });\r\n    },\r\n    //回傳過去病史\r\n    returnuDiagnosis(item) {\r\n      let values = Object.values(item);\r\n      let str = \"\";\r\n      values.forEach((i, index) => {\r\n        if (index > 0) {\r\n          str += \",\";\r\n        }\r\n        str += i;\r\n      });\r\n      return str;\r\n    },\r\n\r\n    //取得指定datatable資料\r\n    getItems(datatable) {\r\n      this.$api.options(\r\n        \"general/getAll/\" + this.$store.state.databaseName + \"/\" + datatable\r\n      ).then((rs) => {\r\n        this[datatable + \"Items\"] = rs;\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\ntbody {\r\n  tr:hover {\r\n    background-color: transparent !important;\r\n  }\r\n}\r\n.PharmacistEvaluationList {\r\n  h2 {\r\n    span {\r\n      vertical-align: middle;\r\n    }\r\n  }\r\n\r\n  .contentStyle {\r\n    font-size: 1.2rem;\r\n  }\r\n\r\n  .rounded {\r\n    border-radius: 5px;\r\n  }\r\n\r\n  .theme--light.v-data-table thead tr th {\r\n    font-size: 1.1rem;\r\n  }\r\n\r\n  .theme--light.v-data-table tbody tr td {\r\n    font-size: 1rem;\r\n    height: 2rem;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PharmacistEvaluationList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PharmacistEvaluationList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PharmacistEvaluationList.vue?vue&type=template&id=6e62403e&\"\nimport script from \"./PharmacistEvaluationList.vue?vue&type=script&lang=js&\"\nexport * from \"./PharmacistEvaluationList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PharmacistEvaluationList.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardText,VCardTitle,VCol,VDivider,VForm,VIcon,VRow,VSelect,VSimpleTable,VSpacer,VTextField,VTextarea})\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PharmacistEvaluationList.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}